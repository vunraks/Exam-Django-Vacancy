{% extends 'base.html' %}
{% load static %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –ü–æ–∏—Å–∫ –≤–∞–∫–∞–Ω—Å–∏–π{% endblock %}

{% block content %}
<section class="search-filter">
    <form method="GET" action="{% url 'vacancy_list' %}">
        <input type="text" name="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é" value="{{ request.GET.search }}">
        <select name="salary">
            <option value="">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
            {% for salary in salaries %}
                <option value="{{ salary }}">{{ salary }} ‚Ç∏</option>
            {% endfor %}
        </select>
        <select name="experience">
            <option value="">–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã</option>
            {% for experience in experiences %}
                <option value="{{ experience }}">{{ experience }}</option>
            {% endfor %}
        </select>
        <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
        <a href="{% url 'vacancy_list' %}" class="button-clear">–°–±—Ä–æ—Å–∏—Ç—å</a>
    </form>
</section>

{% if user.is_authenticated %}
<section class="user-stats">
    <div class="stat-card">
        <p>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏: <strong>{{ user.vacancy_set.count }}</strong></p>
        <p><a href="{% url 'vacancy_create' %}" class="button1">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é</a></p>
    </div>
</section>
{% endif %}

<section class="vacancies">
    <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏ ({{ vacancies|length }})</h2>

    {% if vacancies %}
        {% for vacancy in vacancies %}
            <div class="vacancy">
                <h2><a href="{% url 'vacancy_detail' vacancy.pk %}">{{ vacancy.title }}</a></h2>
                <p><strong>üè¢ –ö–æ–º–ø–∞–Ω–∏—è:</strong> {{ vacancy.company }}</p>
                <p><strong>üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞:</strong> {{ vacancy.salary }}‚Ç∏</p>
                <p><strong>üìÖ –û–ø—ã—Ç:</strong> {{ vacancy.experience }} –ª–µ—Ç</p>
                <p><strong>üìù –°—Ç–∞—Ç—É—Å:</strong>
                    {% if vacancy.status == 'published' %}
                        <span class="status status-published">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</span>
                    {% elif vacancy.status == 'moderation' %}
                        <span class="status status-moderation">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</span>
                    {% else %}
                        <span class="status status-rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</span>
                    {% endif %}
                </p>

                {% if user.is_authenticated and vacancy.author == user %}
                    <div class="vacancy-actions">
                        <a href="{% url 'vacancy_update' vacancy.pk %}" class="btn-edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="{% url 'vacancy_delete' vacancy.pk %}" class="btn-delete">–£–¥–∞–ª–∏—Ç—å</a>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
        
        <div style="text-align: center; margin-top: 30px;">
            <a href="{% url 'vacancy_list' %}" class="button1">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤–∞–∫–∞–Ω—Å–∏–∏</a>
        </div>
    {% else %}
        <div class="no-vacancies">
            <p>üòî –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π.</p>
            {% if not user.is_authenticated %}
                <p><a href="{% url 'login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é!</p>
            {% else %}
                <p><a href="{% url 'vacancy_create' %}">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é</a></p>
            {% endif %}
        </div>
    {% endif %}
</section>
{% endblock %}